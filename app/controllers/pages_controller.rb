class PagesController < ApplicationController
  def show
    if current_user && current_user.can_manage_site?
      @page = Page.find_by!(key:params[:key])
    else
      @page = Page.find_by_attr_cached!(:key, params[:key], :published => true)
    end
    @title = @page.title

    if @page.content.size > 100
      @seo_description = @page.content.slice(0, 100) + '...'
    else
      @seo_description = @page.content
    end
  end

  private
  def page_params
    params.require(:page).permit(:key, :title, :content, :published, :position)
  end
end
